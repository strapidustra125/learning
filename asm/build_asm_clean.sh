#!/bin/bash

# Шаг 1: Компилируем
./build_asm.sh

# Шаг 2: Покажем какие метки вообще есть в файле
grep '^[[:space:]]*\.' main.s

# Шаг 3: Удаляем ВСЕ строки, начинающиеся с .L и содержащие :
sed -i '/^\.L.*:/d' main.s

# Шаг 4: Дополнительно удаляем CFI-директивы и endbr64 если нужно
sed -i '/\.cfi\|endbr64/d' main.s

# Шаг 5: Удаляем все строки с точкой И инструкцию endbr64
sed -i '/^[[:space:]]*\./d' main.s
sed -i '/^[[:space:]]*[0-9]*:/d' main.s